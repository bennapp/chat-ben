<!DOCTYPE html>
<html>
  <head>
    <title>Chat Ben</title>
    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %>
    <%= action_cable_meta_tag %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
    <%= csrf_meta_tags %>
    <%= favicon_link_tag('chatben.ico') %>
    <link href='https://fonts.googleapis.com/css?family=Raleway:700,300' rel='stylesheet' type='text/css'>
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0"/>
    <meta name="google-site-verification" content="d6GGirNd5w02XSsgwv_7PplfPKJ4UYbI0ApTmFwk3xw" />
    <meta property="og:image" content="<%= image_url('chatben_white_small2.png') %>" />
    <meta property="og:description" content="Chat Ben is a crazy awesome place to watch TV on the internet with your friends!!!" />
  </head>
  <script>
    window.twttr = (function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0],
        t = window.twttr || {};
      if (d.getElementById(id)) return t;
      js = d.createElement(s);
      js.id = id;
      js.src = "https://platform.twitter.com/widgets.js";
      fjs.parentNode.insertBefore(js, fjs);

      t._e = [];
      t.ready = function(f) {
        t._e.push(f);
      };

      return t;
    }(document, "script", "twitter-wjs"));

    $(document).ready(function() {
      var cable = new Cable();
      window.currentUser = {};
      currentUser.name = '<%= current_user ? current_user.name : "" %>';
      new Login;
    });
  </script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-75900334-1', 'auto');
    ga('send', 'pageview');
  </script>
  <script>
    var tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
  </script>
  <body>
    <div class="page-header">
      <div class="page-title"><%= link_to image_tag('chatbenlogotv.png'), root_url %>
        <small class="lead">its TV on the internet with your friends.</small>
      </div>
      <div class="authentication-container">
        <div class="total-users-container">
          <span id="total-users"><%= User.where(active: true).count %></span><span> users on now!</span>
          <% if current_user %>
            <%= link_to("Logout: #{current_user.name}", destroy_user_session_path, :method => :delete, class: 'logout-link') %>
          <% end %>
        </div>

        <% unless current_user %>
          <div class="login-notice notice alert alert-info hidden">Login to do that! Chat Ben is much more awesome that way!</div>

          <div class="login-and-signup-button">
            <div class="auth-form-container">
              <%= form_for(User.new, as: :user, url: session_path(:user)) do |f| %>
                <div class="fields">
                  <div class="field">
                    <%= f.text_field :login, class: 'login-field', placeholder: 'Username/Email' %>
                  </div>

                  <div class="field">
                    <%= f.password_field :password, autocomplete: "off", placeholder: 'Password' %>
                  </div>

                  <div class="btn-container">
                    <%= f.submit "Log in", class: 'btn btn-info' %>
                  </div>

                  <div class="btn-container">
                    <%= link_to "Sign up", 'javascript:;', class: 'btn btn-success signup' %>
                  </div>
                </div>
              <% end %>
            </div>
          </div>

          <div class='signup-form-container auth-form-container hidden'>
            <%= form_for(User.new, as: :user, url: registration_path(:user)) do |f| %>
              <div class="fields">
                <div class="field">
                  <%= f.text_field :name, autofocus: true, placeholder: 'Username' %>
                </div>

                <div class="field">
                  <%= f.email_field :email, placeholder: "Email" %>
                </div>

                <div class="field">
                  <%= f.password_field :password, placeholder: 'Password', autocomplete: "off" %>
                </div>

                <div class="actions">
                  <%= f.submit "Sign up!", class: 'btn btn-success auth-btn' %>
                </div>
                <div class="btn-container signup-clear-button">
                  <button type="button" class="btn btn-default" aria-label="Left Align">
                    <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                  </button>
                </div>
              </div>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>

    <% if flash[:notice] %>
      <div class="flash notice alert alert-info"><%= flash[:notice] %></div>
    <% end %>
    <% if flash[:alert] %>
      <div class="flash alert alert-danger"><%= flash[:alert] %></div>
    <% end %>

    <%= yield %>

    <% unless @hide_footer %>
      <div class="navbar navbar-default navbar-fixed-bottom">
        <div class="footer-content">
          <% if current_user && !@is_feeback_new %>
            <%= link_to('Leave Ben Feedback', new_feedback_path) %>
          <% end %>

          <p class="copyright text-muted">2016 Chat Ben</p>
        </div>
      </div>
    <% end %>

    <%= audio_tag('8-bit-coin.wav', id: 'like-sound') %>
    <%= audio_tag('8-bit-wrong.wav', id: 'dislike-sound') %>
  </body>
</html>
